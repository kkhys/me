---
import type { HTMLAttributes } from "astro/types";
import { categories } from "#/features/blog/config/category";
import { cn } from "#/lib/ui";

interface Props extends HTMLAttributes<"div"> {}

const { class: className, ...rest } = Astro.props;

const pathname = Astro.url.pathname;

const linkClass =
  "flex h-6 items-center justify-center rounded-full px-2 text-center text-xs transition-colors whitespace-nowrap";
---

<nav class={cn('category-scroll palt', className)} {...rest}>
  {/^\/blog(\/\d+)?\/?$/.test(pathname) ? (
      <span class={cn(linkClass, "bg-primary/95 text-primary-foreground font-medium")}>
      すべて
    </span>
  ) : (
      <a href="/blog" class={cn(linkClass, "text-muted-foreground hover:text-primary")}>
        すべて
      </a>
  )}
  {categories.map(({ slug, label }) => (
    pathname?.startsWith(`/blog/categories/${slug}`) ? (
        <span class={cn(linkClass, "bg-primary/95 text-primary-foreground font-medium")}>
      {label}
    </span>
    ) : (
        <a href={`/blog/categories/${slug}`} class={cn(linkClass, "text-muted-foreground hover:text-primary")}>
          {label}
        </a>
    )
  ))}
</nav>

<style>
  .category-scroll {
    display: flex;
    align-items: center;
    overflow-x: auto;
    scroll-timeline: --category-scroll inline;
    -ms-overflow-style: none;
    scrollbar-width: none;

    animation: scroll-mask linear both;
    animation-timeline: --category-scroll;
  }

  .category-scroll::-webkit-scrollbar {
    display: none;
  }

  @keyframes scroll-mask {
    0% {
      mask-image: linear-gradient(to right, var(--uchu-yin) calc(100% - 2rem), transparent);
    }
    1%, 99% {
      mask-image: linear-gradient(to right, transparent, var(--uchu-yin) 2rem, var(--uchu-yin) calc(100% - 2rem), transparent);
    }
    100% {
      mask-image: linear-gradient(to right, transparent, var(--uchu-yin) 2rem, var(--uchu-yin) 100%);
    }
  }
</style>
