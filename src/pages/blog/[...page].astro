---
import type { PaginateFunction } from "astro";
import ArrowLeftIcon from "#/components/icons/arrow-left.svg";
import BaseSEO from "#/components/seo/base-seo.astro";
import OpenGraph from "#/components/seo/open-graph.astro";
import TwitterCard from "#/components/seo/twitter-card.astro";
import { countPerPage } from "#/config/constant";
import { siteConfig } from "#/config/site";
import CategoryNavigation from "#/features/blog/components/ui/category-navigation.astro";
import EntryList from "#/features/blog/components/ui/entry-list.astro";
import Pagination from "#/features/blog/components/ui/pagination.astro";
import { getPublicBlogEntries } from "#/features/blog/utils/entry";
import BaseLayout from "#/layouts/base-layout.astro";
import { BASE_URL } from "#/lib/base-url";

export const getStaticPaths = async ({
  paginate,
}: {
  paginate: PaginateFunction;
}) => {
  const blogEntries = await getPublicBlogEntries();
  return paginate(blogEntries, { pageSize: countPerPage });
};

const { page } = Astro.props;

const seoTitle = `ブログ｜${siteConfig.title}`;
const seoDescription = "Keisuke Hayashi のブログ";
const seoImage = `${BASE_URL}/api/og/default.png`;
---

<BaseLayout>
  <Fragment slot='seo'>
    <BaseSEO title="ブログ" description={seoDescription} />
    <OpenGraph
      title={seoTitle}
      description={seoDescription}
      image={seoImage}
      imageAlt={seoTitle}
    />
    <TwitterCard
      title={seoTitle}
      description={seoDescription}
      image={seoImage}
      imageAlt={seoTitle}
    />
  </Fragment>
  <div class="mb-4 xl:fixed xl:top-0 xl:translate-y-[170px] xl:-translate-x-[260px]">
    <a href="/" class="inline-flex gap-1 items-center text-muted-foreground text-xs hover:underline">
      <ArrowLeftIcon class="size-3.5" />
      ホーム
    </a>
  </div>
  <section>
    <h1 class="font-medium">ブログ</h1>
    <CategoryNavigation class="mt-8" />
  </section>
  <section class="mt-6">
    <EntryList blogEntries={page.data} showDate />
  </section>
  <Pagination page={page} baseUrl="/blog" class="mt-6" />
</BaseLayout>
