---
title: Play Framework ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã« TypeScript ã‚’çµ„ã¿è¾¼ã‚€
emoji: ğŸ”¨
category: Tech
tags: ["Play Framework", "TypeScript"]
status: published
publishedAt: 2024-02-18
---

Scala / Java å‘ã‘ã® Web ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã‚ã‚‹ [Play Framework](https://www.playframework.com) ã‚’ä»•äº‹ã§ä½¿ã£ã¦ãŠã‚Šã€ã„ãã¤ã‹çŸ¥è¦‹ãŒæºœã¾ã£ã¦ããŸã®ã§ã“ã®ãƒ–ãƒ­ã‚°ã§æ›¸ã„ã¦ã„ã“ã†ã¨æ€ã†ã€‚

Play Framework ã¨ã„ãˆã°ä¸€èˆ¬çš„ã«ã¯ Scala ã§ä½¿ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚
ãŸã ã€ç§ã®å ´åˆã¯ Java ã®æ–¹ãŒæ…£ã‚Œã¦ã„ã‚‹ã®ã§åŸºæœ¬çš„ã«ã¯ Java ã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ã¦ã„ãã€‚

ã•ã¦ã€ã‚¿ã‚¤ãƒˆãƒ«ã®é€šã‚Šã ãŒã€Play Framework ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã¨ãã« TypeScript ã‚’çµ„ã¿è¾¼ã‚€å‡¦ç†ã‚’æ›¸ãç•™ã‚ã¦ã„ãã€‚

## ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³

å‰æã¨ã—ã¦ã€ä»Šã‹ã‚‰æ–°ãŸã«ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚’ã™ã‚‹ã®ã§ã‚ã‚Œã° TypeScript ã¯å¿…é ˆã¨ã„ã†èªè­˜ã‚’ç§ã¯æŒã£ã¦ã„ã‚‹ã€‚
å‹ãŒãªã„ç´ ã® JavaScript ã¯ã©ã†ã—ã¦ã‚‚é–‹ç™ºåŠ¹ç‡ãŒè½ã¡ã‚‹ã€‚

[Ruby on Rails](https://rubyonrails.org) ã§ã‚ã‚Œã° `rails new` ã™ã‚‹ã¨ãã« esbuild ã‚’ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«è¿½åŠ ã™ã‚‹ã ã‘ã§ TypeScript ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚
Ruby ãŒå‹•çš„å‹ä»˜ã‘è¨€èªãªã®ã‚’é™¤ã‘ã°æœ€é«˜ã®ç’°å¢ƒã§ã‚ã‚‹ã€‚

ä¸€æ–¹ã€Play Frameworkï¼ˆRuby on Rails ã®å½±éŸ¿ã‚’å—ã‘ã¦ä½œã‚‰ã‚ŒãŸï¼‰ã¯ã„ã¾ã ã« [CoffeeScript](https://coffeescript.org) ã‚„ [RequireJS](https://requirejs.org) ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã«ã—ã‹å¯¾å¿œã—ã¦ã„ãªã„ã€‚
ä»Šã©ã CoffeeScript ã‚’ä½¿ã†äººãŒã„ã‚‹ã®ã‹ã¯ç”šã ç–‘å•ã ãŒã€ãã‚Œã‚‰ãŒæµè¡Œã£ã¦ã„ãŸé ƒã‹ã‚‰ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’æ‰±ã†æ©Ÿæ§‹ãŒå¤‰ã‚ã£ã¦ã„ãªã„ãŸã‚ã“ã®ã‚ˆã†ãªã“ã¨ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã ã€‚

Play Framework ãŒå…¬å¼ã« TypeScript å¯¾å¿œã—ã¦ãã‚Œã‚Œã°è‰¯ã„ã®ã ãŒå½“åˆ†å¯¾å¿œã—ãªã„ã—ã€CoffeeScript ã‚µãƒãƒ¼ãƒˆã‚’å»ƒæ­¢ã™ã‚‹æ°—ã‚‚ãªã„ã‚‰ã—ã„ï¼ˆ[ã‚½ãƒ¼ã‚¹](https://github.com/playframework/playframework/issues/12045)ï¼‰ã€‚

ãã“ã§ã€ãã®å‡¦ç†ã‚’è‡ªåˆ†ã§çµ„ã¿è¾¼ã‚“ã§é–‹ç™ºã‚’æ¥½ã«ã—ãŸã„ã¨ã„ã†ã®ãŒãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã ã€‚
Play Framework ã¨ã¯åˆ¥ã« TypeScript ã®ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ã‚’èµ·å‹•ã•ã›ã¦ã¨ã„ã†ã®ã¯é¢å€’ãªã®ã§ `sbt run` ã ã‘ã§å…¨ã¦ãŒå®Œçµã™ã‚‹ã‚ˆã†ã«ã—ãŸã„ã€‚

ã¾ãŸã€ã¤ã„ã§ã¨è¨€ã£ã¦ã¯ä½•ã ãŒã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³å†…ã§ Tailwind CSS ã‚’ä½¿ã£ãŸã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ãŒã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨å¤‰æ›´ãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã€‚

## ã“ã®ãƒšãƒ¼ã‚¸ã§å®Ÿç¾ã™ã‚‹ã“ã¨

- TypeScript ã§æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ãŒãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã•ã‚Œã¦ `puclic/javascripts` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã«é…ç½®ã•ã‚Œã‚‹
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³å†…ã§æ›¸ã„ãŸ Tailwind CSS ã®ã‚¯ãƒ©ã‚¹ãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã¦ `puclic/stylesheets` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã«é…ç½®ã•ã‚Œã‚‹
- `sbt run` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ TypeScript ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ©ã¨ Tailwind CSS ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒèµ·å‹•ã™ã‚‹ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰åˆ¥é€”ç«‹ã¡ä¸Šã’ãªãã¦ã„ã„ï¼‰
- ç”»é¢ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨é€šå¸¸ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«åŠ ãˆã¦ TypeScript ã¨ Tailwind CSS ã‚‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œå¤‰æ›´ãŒåæ˜ ã•ã‚Œã‚‹ï¼ˆãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰å¯¾å¿œï¼‰
- Cache Busting ã®ãŸã‚ã«ç”Ÿæˆã—ãŸé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã‚’ä»˜ä¸ã™ã‚‹
- `sbt dist` ã§ãƒ“ãƒ«ãƒ‰ã—ãŸãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã« TypeScript ã¨ Tailwind CSS ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒæ¢±ã™ã‚‹

## é–‹ç™ºç’°å¢ƒ

- Play Framework: 3.0.1
- Java: 21.0.1
- Scala: 3.3.1
- sbt: 1.9.6
- Vite: 5.1.1
- TypeScript: 5.3.3

## sbt-web ã§å®Ÿè£…ã§ããªã„ã‹

https://ancozerticht.hatenablog.com/entry/2023/03/20/013910

ã“ã¡ã‚‰ã®è¨˜äº‹ã«ã‚ã‚‹æ–¹æ³•ã§ TypeScript ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã‚’çµ„ã¿è¾¼ã‚ãŸã‚‰æ¥½ã ã‚ã†ãªã‚ã¨æ€ã£ã¦ã‚„ã£ã¦ã¿ãŸãŒã€`tsconfig.json` ã‚’è‡ªç”±ã«è¨˜è¼‰ã§ããªã‹ã£ãŸã‚Šã€å†…éƒ¨ã§ã©ã®ã‚ˆã†ã«ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã•ã‚Œã¦ã„ã‚‹ã®ã‹åˆ†ã‹ã‚‰ãšã«ãƒ‡ãƒãƒƒã‚°ã«è‹¦åŠ´ã™ã‚‹æœªæ¥ãŒè¦‹ãˆãŸã®ã§å°å…¥ã‚’è¦‹é€ã£ãŸã€‚

çµå±€ Vite ã§ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã—ã¦ã‹ã‚‰ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ `public` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã«é…ç½®ã—ã¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ã¦ã‚‚ã‚‰ã†æ–¹æ³•ãŒè‰¯ã•ãã†ã€‚

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã€‚
ãƒã‚¤ã‚ºã«ãªã‚Šãã†ãªéƒ¨åˆ†ã¯è¨˜è¼‰ã—ã¦ã„ãªã„ã€‚

```text
.
|-- app
|   |-- controllers
|   |   `-- HomeController.java
|   `-- views
|       |-- index.scala.html
|       `-- main.scala.html
|-- build.sbt
|-- conf
|   |-- application.conf
|   `-- routes
|-- frontend
|   |-- package.json
|   |-- src
|   |   |-- entries
|   |   |   `-- main.ts
|   |   `-- styles
|   |       `-- input.css
|   |-- tailwind.config.ts
|   |-- tsconfig.json
|   `-- vite.config.mts
`-- public
    |-- javascripts
    |   `-- main.js
    `-- stylesheets
        `-- main.css
```

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ã¯ `frontend` ä»¥ä¸‹ã§ç®¡ç†ã™ã‚‹ã€‚

`frontend/src/entries/main.ts` ãŒãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã™ã‚‹éš›ã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã«ãªã‚‹ã€‚
ãã“ã«æ›¸ã‹ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸå¾Œã« `public/javascripts` ä»¥ä¸‹ã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚

Tailwind CSS ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã¯ `public/main.css` ã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚

## Vite ã®ç’°å¢ƒæ§‹ç¯‰

ä½•ã¯ã¨ã‚‚ã‚ã‚Œã€ã¾ãšã¯ Vite ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ã¤ã„ã§ã« TypeScript ã‚‚ã€‚
ä»Šå›ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã«ã¯ pnpm ã‚’ä½¿ã£ã¦ã„ã‚‹ãŒ Yarn ã§ã‚‚ Bun ã§ã‚‚ä½•ã‚’ä½¿ã£ã¦ã‚‚å•é¡Œãªã„ã€‚

```shell
pnpm add -D vite typescript @types/node
```

æ¬¡ã« Vite ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã€‚

```ts title="frontend/vite.config.mts" showLineNumbers
import { resolve } from 'path';
import { defineConfig } from 'vite';

export default defineConfig({
  build: {
    emptyOutDir: true,
    lib: {
      entry: [resolve(__dirname, 'src', 'entries', 'main.ts')],
      formats: ['es'],
      fileName: (_, entryName) => `${entryName}.js`,
    },
    outDir: resolve(__dirname, '..', 'public', 'javascripts'),
  },
});
```

ä»Šå›ã¯ SPA ã‚’ä½œã‚‹ã“ã¨ãŒç›®çš„ã§ã¯ãªã„ã®ã§ Vite ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã€‚
`lib` ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¢ãƒ¼ãƒ‰ãŒä½¿ãˆã‚‹ã€‚

ã“ã“ã§é‡è¦ãªã®ã§ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã®è¨­å®šã¨ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›å…ˆã§ã‚ã‚‹ã€‚
JavaScript ã§ã¯ `path.resolve()` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦çµ¶å¯¾ãƒ‘ã‚¹ã«å¤‰æ›ã™ã‚‹ã€‚

ã“ã“ã§ã¯ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã‚’ `frontend/src/entries/main.ts`ã€ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆå…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ `public/javascripts` ã¨ã—ã¦ã„ã‚‹ã€‚

å®Ÿéš›ã«ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹ã‹ç¢ºèªã—ã¦ã¿ã‚‹ã€‚

ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã« TypeScript ã§æ›¸ã‹ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’é…ç½®ã™ã‚‹ã€‚
ä¾‹ã¨ã—ã¦ã€å®Ÿè¡Œã™ã‚‹ã¨ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é–‹ã„ã¦ã€å…¥åŠ›ã—ãŸæ–‡å­—ã‚’ [ã‚·ãƒ¼ã‚¶ãƒ¼æš—å·](https://w.wiki/6iYC) ã«å¤‰æ›ã™ã‚‹å‡¦ç†ã‚’æ›¸ã„ã¦ã¿ãŸã€‚

```ts title="frontend/src/entries/main.ts" showLineNumbers
const ALPHABET = 'abcdefghijklmnopqrstuvwxyz'.split('');

/**
 * Calculates the shifted index based on the current index and shift amount.
 *
 * @param currentIndex - The current index.
 * @param shiftAmount - The amount to shift the index.
 * @returns The shifted index.
 */
const getShiftedIndex = (currentIndex: number, shiftAmount: number): number => {
  let newIndex = currentIndex + shiftAmount;
  if (newIndex > 25) newIndex = newIndex - 26;
  if (newIndex < 0) newIndex = 26 + newIndex;
  return newIndex;
};

/**
 * Converts a string using the Caesar cipher algorithm.
 *
 * @returns The converted string.
 */
window.convertCaesarCipher = () => {
  const inputString = prompt('Enter a string to be shifted') || '';
  if (!inputString) return alert('You must enter a string to be shifted');

  let shiftAmount = parseInt(prompt('Enter a shift amount') || '');
  if (isNaN(shiftAmount)) return alert('You must enter a valid shift amount');

  shiftAmount = shiftAmount % 26;
  const lowerCaseString = inputString.toLowerCase();
  let shiftedString = '';

  Array.from(lowerCaseString).forEach((currentLetter, i) => {
    if (currentLetter === ' ') {
      shiftedString += currentLetter;
      return;
    }

    const currentIndex = ALPHABET.indexOf(currentLetter);
    const shiftedIndex = getShiftedIndex(currentIndex, shiftAmount);

    if (inputString[i] === inputString[i].toUpperCase()) {
      shiftedString += ALPHABET[shiftedIndex].toUpperCase();
    } else shiftedString += ALPHABET[shiftedIndex];
  });

  return alert(shiftedString);
};
```

æ¯å› Vite ã®ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ‰“ã¡è¾¼ã‚€ã®ã¯é¢å€’ãªã®ã§ `package.json` ã« npm ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦è¿½åŠ ã™ã‚‹ã€‚

```json title="frontend/package.json"
{
  "name": "play-framework-java-playground",
  "private": true,
  "scripts": {
    "vite:dev": "vite build --watch",
    "vite:build": "vite build"
  }
}
```

`vite:dev` ã¯é–‹ç™ºç”¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã€å¤‰æ›´ãŒç›£è¦–ã•ã‚Œã¦ãŠã‚Šãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ã«å¯¾å¿œã—ã¦ã„ã‚‹ã€‚
`vite:build` ã¯æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã«å®Ÿè¡Œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã€ã‚³ãƒ¼ãƒ‰ã‚’ minify ã™ã‚‹ã€‚
ã“ã“ã§ã¯ `vite:build` ã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹ã€‚

ã™ã‚‹ã¨ã€`public/javascripts/main.js` ã«ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã€‚

```js title="public/javascripts/main.js" showLineNumbers
const i = "abcdefghijklmnopqrstuvwxyz".split(""), d = (e, n) => {
  let t = e + n;
  return t > 25 && (t = t - 26), t < 0 && (t = 26 + t), t;
};
window.convertCaesarCipher = () => {
  const e = prompt("Enter a string to be shifted") || "";
  if (!e)
    return alert("You must enter a string to be shifted");
  let n = parseInt(prompt("Enter a shift amount") || "");
  if (isNaN(n))
    return alert("You must enter a valid shift amount");
  n = n % 26;
  const t = e.toLowerCase();
  let r = "";
  return Array.from(t).forEach((s, o) => {
    if (s === " ") {
      r += s;
      return;
    }
    const f = i.indexOf(s), a = d(f, n);
    e[o] === e[o].toUpperCase() ? r += i[a].toUpperCase() : r += i[a];
  }), alert(r);
};
```

å•é¡Œãªããƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã«æˆåŠŸã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚

## public ãƒªã‚½ãƒ¼ã‚¹ã®æ“ä½œ

æ¬¡ã«ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã—ãŸ JavaScript ã‚’ Play Framework ã® View ã§ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
ä»Šå›ã¯å‹•ä½œç¢ºèªãªã®ã§æœ€ä½é™ã®æº–å‚™ã‚’ã™ã‚‹ã€‚

```text title="conf/routes"
GET        /                    controllers.HomeController.index()
```

```java title="app/controllers/HomeController.java" showLineNumbers
package controllers;

import play.mvc.Controller;
import play.mvc.Http.Request;
import play.mvc.Result;

public class HomeController extends Controller {
    public Result index() {
        return ok(views.html.index.render());
    }
}
```

```html title="app/views/main.scala.html" showLineNumbers
@(title: String)(content: Html)

<!DOCTYPE html>
<html lang="ja">
    <head>
        <title>@title</title>
    </head>
    <body>
        @content
    </body>
</html>
```

```html title="app/views/index.scala.html" showLineNumbers
@()

@main("Welcome to Play") {
  <h1>Welcome to Play!</h1>
}
```

ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ã§ `http://localhost:9000` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ç”»é¢ãŒæç”»ã•ã‚Œã‚‹ã€‚

`public` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ Play Framework ã®ã‚¢ã‚»ãƒƒãƒˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¨ã—ã¦ä½¿ã†ãŸã‚ã«ã¯ `routes` ãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã®è¨­å®šã‚’è¿½åŠ ã™ã‚‹ã€‚
ã“ã®æ“ä½œã‚’çµŒã‚‹ã“ã¨ã§ Reverse routingï¼ˆãƒªã‚½ãƒ¼ã‚¹ã® URL ã‚’å–å¾—ã§ãã‚‹ï¼‰ãŒä½¿ç”¨å¯èƒ½ã«ãªã‚‹ã€‚

```text title="conf/routes"
GET        /                    controllers.HomeController.index()

GET        /assets/*file        controllers.Assets.versioned(path="/public", file: Asset) // [!code ++]
```

`versioned` ã¨ã—ã¦ã„ã‚‹ã®ã¯å¾Œã€…ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã«ä½¿ç”¨ã™ã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚

ä¸Šè¨˜ã§ `puclic` ã‚’ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«è¿½åŠ ã—ãŸã“ã¨ã§ View ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ä»¥ä¸‹ã®ã‚ˆã†ã« `puclic` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã®é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚

```html title="app/views/main.scala.html"
@(title: String)(content: Html)

<!DOCTYPE html>
<html lang="ja">
    <head>
        <title>@title</title>
        <script type="module" src="@routes.Assets.versioned("javascripts/main.js")" async></script> // [!code ++]
    </head>
    <body>
        @content
    </body>
</html>
```

æ—©é€Ÿ JavaScript ã‚’å‘¼ã³å‡ºã›ã‚‹ã‹ç¢ºèªã—ã¦ã¿ã‚‹ã€‚

```html title="app/views/index.scala.html" showLineNumbers
@()

@main("Welcome to Play") {
  <h1>Welcome to Play!</h1>
  <button onclick="convertCaesarCipher()">
    Convert to Caesar cipher
  </button>
}
```

ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã€å•é¡Œãªãã‚·ãƒ¼ã‚¶ãƒ¼æš—å·ã«å¤‰æ›ã§ããŸã€‚

## Tailwind CSS ã®ç’°å¢ƒæ§‹ç¯‰

TypeScript ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã¯å®Œäº†ã—ãŸã®ã§ã€æ¬¡ã« Tailwind CSS ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«è¨­å®šã‚’è¿½åŠ ã—ã¦ã„ãã€‚

ã¾ãšã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‹ã‚‰ã€‚

```shell
pnpm add -D tailwindcss
```

æ¬¡ã« Tailwind CSS ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã€‚

```ts title="frontend/tailwind.config.ts" showLineNumbers
import type { Config } from 'tailwindcss';

export default {
  content: ['../app/views/*.scala.html'],
  theme: {
    extend: {},
  },
  plugins: [],
} satisfies Config;
```

ã“ã“ã§å¤§äº‹ãªã®ã¯ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å¯¾è±¡ã«ã™ã‚‹ã‹ã¨ã„ã†ã“ã¨ã§ã‚ã‚‹ã€‚
ä¸Šè¨˜ã§ã¯ `app/views` ä»¥ä¸‹ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆTwirlï¼‰ã®æ‹¡å¼µå­ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã€‚
æœ€åˆã¯ã€ç´”ç²‹ãª HTML ã§ã¯ãªã„ã®ã§ã†ã¾ãã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã‚‹ã‹å¿ƒé…ã ã£ãŸãŒã€ç‰¹ã«å•é¡Œãªãå¿…è¦ãªã‚¹ã‚¿ã‚¤ãƒ«ã®ã¿å‡ºåŠ›ã•ã‚ŒãŸã€‚

è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ ãŒçµ‚ã‚ã£ãŸã‚‰ Tailwind ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ç½®ããŸã‚ã® CSS ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚

```css title="frontend/src/styles/input.css" showLineNumbers
@tailwind base;
@tailwind components;
@tailwind utilities;
```

ç¶šã„ã¦ npm ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ ã™ã‚‹ã€‚

```json title="frontend/package.json"
{
  "name": "play-framework-java-playground",
  "private": true,
  "scripts": {
    "vite:dev": "vite build --watch",
    "vite:build": "vite build",
    "tailwind:dev": "tailwindcss -i src/styles/input.css -o ../public/stylesheets/main.css --watch=always", // [!code ++]
    "tailwind:build": "tailwindcss -i src/styles/input.css -o ../public/stylesheets/main.css --minify" // [!code ++]
  }
}
```

æœ€å¾Œã« CSS ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã€‚

```html title="app/views/main.scala.html"
@(title: String)(content: Html)

<!DOCTYPE html>
<html lang="ja">
    <head>
        <title>@title</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/main.css")"> // [!code ++]
        <script type="module" src="@routes.Assets.versioned("javascripts/main.js")" async></script>
    </head>
    <body>
        @content
    </body>
</html>
```

`tailwind:build` ã‚’å®Ÿè¡Œå¾Œã€ã¡ã‚ƒã‚“ã¨ã‚¹ã‚¿ã‚¤ãƒ«ãŒåŠ¹ãã‹ç¢ºèªã—ã¦ã¿ã‚‹ã€‚

```html title="app/views/index.scala.html" showLineNumbers
@()

@main("Welcome to Play") {
  <h1 class="text-xl text-neutral-500">Welcome to Play!</h1>
  <button class="rounded-lg border-amber-200 bg-amber-200 p-2 text-amber-900 transition-colors hover:bg-amber-300" onclick="convertCaesarCipher()">
    Convert to Caesar cipher
  </button>
}
```

`tailwind:build` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ `public/stylesheets/main.css` ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚

```css title="public/stylesheets/main.css" showLineNumbers
/*! tailwindcss v3.4.1 | MIT License | https://tailwindcss.com*/*,:after,:before{box-sizing:border-box;border:0 solid #e5e7eb}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:initial}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:initial;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:initial}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,::backdrop,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#3b82f680;--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.rounded-lg{border-radius:.5rem}.border-amber-200{--tw-border-opacity:1;border-color:rgb(253 230 138/var(--tw-border-opacity))}.bg-amber-200{--tw-bg-opacity:1;background-color:rgb(253 230 138/var(--tw-bg-opacity))}.p-2{padding:.5rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-amber-900{--tw-text-opacity:1;color:rgb(120 53 15/var(--tw-text-opacity))}.text-neutral-500{--tw-text-opacity:1;color:rgb(115 115 115/var(--tw-text-opacity))}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.hover\:bg-amber-300:hover{--tw-bg-opacity:1;background-color:rgb(252 211 77/var(--tw-bg-opacity))}
```

`http://localhost:9000` ã‚’é–‹ã„ã¦ç¢ºèªã™ã‚‹ã¨ã‚¹ã‚¿ã‚¤ãƒ«ãŒé©ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ããŸã€‚

## PlayRunHook ã‚’ä½¿ã£ã¦ sbt run ã‚’æ‹¡å¼µã™ã‚‹

PlayRunHook ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã®å‡¦ç†ã‚’å¤‰æ›´ã§ãã‚‹ã€‚
ã“ã“ã§ã¯é€šå¸¸ã® Play Framework ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«åŠ ãˆã¦ã€Vite ã¨ Tailwind ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’åŒæ™‚ã«è¡Œãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼ˆ[å‚è€ƒ](https://www.playframework.com/documentation/2.7.1/SBTCookbook)ï¼‰ã€‚

`project/PlayDevRunHook.scala` ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã€‚

```scala title="project/PlayDevRunHook.scala" showLineNumbers
import java.io.PrintWriter
import play.sbt.PlayRunHook
import sbt.*

import scala.io.Source
import scala.language.reflectiveCalls
import scala.sys.process.Process

object PlayDevRunHook {

  object FrontendCommands {
    val install = "pnpm install"
    val viteDev = "pnpm vite:dev"
    val tailwindDev = "pnpm tailwind:dev"
  }

  object Shell {
    /**
     * Execute a command in the shell
     *
     * @param cmd  command to execute
     * @param cwd  working directory
     * @param envs environment variables
     * @return exit code
     */
    def execute(cmd: String, cwd: File, envs: (String, String)*): Int = {
      Process(cmd, cwd, envs *).!
    }

    /**
     * Invoke a command in the shell
     *
     * @param cmd  command to execute
     * @param cwd  working directory
     * @param envs environment variables
     * @return process
     */
    def invoke(cmd: String, cwd: File, envs: (String, String)*): Process = {
      Process(cmd, cwd, envs *).run
    }
  }

  /**
   * Create a PlayRunHook to watch frontend changes
   *
   * @param base base directory
   * @return PlayRunHook
   */
  def apply(base: File): PlayRunHook = {

    val frontendBase = base / "frontend"
    val packageJsonPath = frontendBase / "package.json"

    val frontEndTarget = base / "target" / "frontend"
    val packageJsonHashPath = frontEndTarget / "package.json.hash"

    object FrontendBuildProcess extends PlayRunHook {
      var processes: List[Process] = Nil

      /**
       * Invoked before the Play application starts
       */
      override def beforeStarted(): Unit = {
        def using[A <: { def close(): Unit }, B](resource: A)(file: A => B): B =
          try {
            file(resource)
          } finally {
            resource.close()
          }

        println("Hook to Play Framework dev run -- beforeStarted")

        val currPackageJsonHash = using(Source.fromFile(packageJsonPath)) { source =>
          source.getLines().mkString.hashCode().toString
        }

        val oldPackageJsonHash = getStoredPackageJsonHash

        if (!oldPackageJsonHash.contains(currPackageJsonHash)) {
          println(s"Found new/changed package.json. Run '${FrontendCommands.install}'...")

          Shell.execute(FrontendCommands.install, frontendBase)

          updateStoredPackageJsonHash(currPackageJsonHash)
        }
      }

      /**
       * Invoked after the Play application has been started
       */
      override def afterStarted(): Unit = {
        println(s"> Watching frontend changes in $frontendBase")
        processes = List(
          Shell.invoke(FrontendCommands.viteDev, frontendBase),
          Shell.invoke(FrontendCommands.tailwindDev, frontendBase)
        )
      }

      /**
       * Invoked after the Play application has been stopped
       */
      override def afterStopped(): Unit = {
        processes.foreach(_.destroy())
        processes = Nil
      }

      /**
       * Get the stored package.json hash
       *
       * @return hash
       */
      private def getStoredPackageJsonHash: Option[String] = {
        def using[A <: { def close(): Unit }, B](resource: A)(file: A => B): B =
          try {
            file(resource)
          } finally {
            resource.close()
          }

        if (packageJsonHashPath.exists()) {
          using(Source.fromFile(packageJsonHashPath)) { source =>
            Some(source.getLines().mkString)
          }
        } else {
          None
        }
      }

      /**
       * Update the stored package.json hash
       *
       * @param hash hash
       */
      private def updateStoredPackageJsonHash(hash: String): Unit = {
        val dir = frontEndTarget

        if (!dir.exists) dir.mkdirs

        val pw = new PrintWriter(packageJsonHashPath)

        try {
          pw.write(hash)
        } finally {
          pw.close()
        }
      }
    }

    FrontendBuildProcess
  }
}
```

æ¬¡ã« `build.sbt` ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½è¨˜ã™ã‚‹ã€‚

```text title="build.sbt"
import scala.sys.process.Process

name := """play-framework-java-playground"""
organization := "me.kkhys"
maintainer := "hi@kkhys.me"

ThisBuild / scalaVersion := "3.3.1"

ThisBuild / version := "1.0.0-SNAPSHOT"

lazy val root = (project in file("."))
  .enablePlugins(PlayJava)
  .settings(
    libraryDependencies ++= Seq(
      guice,
      "com.google.inject" % "guice" % "5.1.0",
      "com.google.inject.extensions" % "guice-assistedinject" % "5.1.0"
    )
  )

PlayKeys.playRunHooks += baseDirectory.map(PlayDevRunHook.apply).value // [!code ++]
```

`sbt run` ã‚’å®Ÿè¡Œã™ã‚‹ã¨åŒæ™‚ã« Vite ã¨ Tailwind ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚‚è¡Œã‚ã‚Œã€å¤‰æ›´ã—ãŸéš›ã«ã‚‚ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ããŸã€‚

## dist æ™‚ã«é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒæ¢±ã™ã‚‹

`sbt run` ã‚’å®Ÿè¡Œã—ãŸã¨ãã®å¯¾å¿œã¯å®Œäº†ã—ãŸã®ã§ã€æ¬¡ã¯ `sbt dist` ã§å®Ÿè¡Œå¯èƒ½ãªãƒã‚¤ãƒŠãƒªã‚’ç”Ÿæˆã™ã‚‹éš›ã«ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒæ¢±ã™ã‚‹å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹ã€‚

ã“ã¡ã‚‰ã¯ã‚·ãƒ³ãƒ—ãƒ«ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ `build.sbt` ã«è¿½åŠ ã™ã‚‹ã ã‘ã§è‰¯ã„ã€‚

```text title="build.sbt"
import scala.sys.process.Process // [!code ++]

...

lazy val frontEndBuild = taskKey[Unit]("Execute frontend build command") // [!code ++]

val frontendPath = "frontend" // [!code ++]
val frontEndFile = file(frontendPath) // [!code ++]

frontEndBuild := { // [!code ++]
  println(Process("pnpm install", frontEndFile).!!) // [!code ++]
  println(Process("pnpm vite:build", frontEndFile).!!) // [!code ++]
  println(Process("pnpm tailwind:build", frontEndFile).!!) // [!code ++]
} // [!code ++]

dist := (dist dependsOn frontEndBuild).value // [!code ++]
stage := (stage dependsOn dist).value // [!code ++]
```

## ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã‚’é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã«ä»˜ä¸ã™ã‚‹

æœ€å¾Œã«ãƒ•ã‚¡ã‚¤ãƒ«åã«ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã¨ãªã‚‹æ–‡å­—åˆ—ã‚’è¿½åŠ ã—ã¦ã„ãã€‚

ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã‚’ä»˜ã‘ã‚‹ã“ã¨ã§ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸã®ã«ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯å¤‰æ›´ãŒåæ˜ ã•ã‚Œãªã„ã¨ã„ã£ãŸå•é¡Œã‚’è§£æ±ºã§ãã‚‹ã€‚
ã“ã®æ‰‹æ³•ã®ã“ã¨ã‚’ Cache Busting ã¨ã„ã†ã€‚

`puclic` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã‚’ä»˜ä¸ã™ã‚‹ãŸã‚ã«ã¯ [sbt-digest](https://github.com/sbt/sbt-digest) ãŒå¿…è¦ãªã®ã§è¿½åŠ ã™ã‚‹ã€‚

```text title="project/plugins.sbt"
addSbtPlugin("org.playframework" % "sbt-plugin" % "3.0.1")
addSbtPlugin("com.github.sbt" % "sbt-digest" % "2.0.0") // [!code ++]

ThisBuild / libraryDependencySchemes += "org.scala-lang.modules" %% "scala-xml" % VersionScheme.Always
```

æ¬¡ã« `build.sbt` ã«ä»¥ä¸‹ã®è¨­å®šã‚’è¿½åŠ ã™ã‚‹ã€‚

```text title="build.sbt"
...

lazy val root = (project in file("."))
  .enablePlugins(PlayJava)
  .enablePlugins(SbtWeb) // [!code ++]
  .settings(
    libraryDependencies ++= Seq(
      guice,
      "com.google.inject" % "guice" % "5.1.0",
      "com.google.inject.extensions" % "guice-assistedinject" % "5.1.0"
    )
  )

Assets / pipelineStages := Seq(digest) // [!code ++]
```

`Assets / pipelineStages` ã®å‡¦ç†ã‚’è¿½åŠ ã—ã¦ã„ã‚‹ã®ã¯ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã‚‚ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚

é–‹ç™ºç’°å¢ƒã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèªã™ã‚‹ã¨ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸã€‚

```text
/assets/stylesheets/b993b456bf80af0695501c8acd69ab8c-main.css
```

ä½•ã‚‚å¤‰æ›´ã›ãšã«ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã¯å¤‰ã‚ã‚‰ãªã„ãŒã€å°‘ã—ã§ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ã®å¯¾è±¡ã¨ãªã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã¨ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆãŒå¤‰åŒ–ã™ã‚‹ã€‚
ã¡ãªã¿ã« sbt ã‚’å†èµ·å‹•ã—ã¦ã‚‚ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã®å€¤ã¯å¤‰åŒ–ã™ã‚‹ã€‚

```text
/assets/stylesheets/58c0961b8f2d1f3b0837dd4fe7c8c86b-main.css
```

## ã•ã„ã”ã«

TypeScript ãŒã‚ã‚‹ã ã‘ã§ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã®å®‰å¿ƒåº¦ã¯ã™ã”ãé«˜ã¾ã‚‹ã€‚
ã©ã‚“ã©ã‚“ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦å¤‰æ›´ã‚’ç¢ºèªã™ã‚Œã°ãƒ¢ãƒ€ãƒ³ãª SPA ã¨åŒç­‰ã®é–‹ç™ºä½“é¨“ã‚’å¾—ã‚‰ã‚Œã‚‹ã€‚

ã¨è¨€ã„ãŸã„ã¨ã“ã‚ã ãŒã€ã‚ãã¾ã§ãƒ¡ã‚¤ãƒ³ã®å‡¦ç†ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«æ›¸ã„ã¦ã„ãå½¢ã«ãªã‚‹ã®ã§ã€ãƒªãƒ­ãƒ¼ãƒ‰ã®ãŸã³ã«é€€å±ˆãªæ™‚é–“ã‚’éã”ã•ãªã„ã¨ã„ã‘ãªã„ç‚¹ã¯ã‚ã¾ã‚Šå¤‰ã‚ã‚Šãªã„ï¼ˆPlay Framework ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¯ã™ã”ãé…ã„ï¼‰ã€‚

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®ä¸Šã« SPA ã‚’è¼‰ã›ã‚Œã°ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã ã‘å¾…ã¦ã°ã‚ˆããªã‚Šã²ã¨ã¾ãšé–‹ç™ºä½“é¨“ã¯ã‚ˆããªã‚‹ãŒã€ãã‚Œãªã‚‰ Next.js ãªã©ã® Web ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’åˆã‚ã‹ã‚‰ä½¿ã£ã¦ API ã®ã¿ Play Framework ã§æ›¸ã‘ã°è‰¯ã„ã‹ã‚‰ãã‚‚ãã‚‚ã®ç›®çš„ãŒæ›–æ˜§ã«ãªã‚‹ã€‚

ã‚‚ã—ã€SPA ã‚’ä½¿ã†ã®ã§ã‚ã‚Œã°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³å†…ã®ä¸€éƒ¨åˆ†ã ã‘é©ç”¨ã™ã‚‹ã¨ã„ã£ãŸã‚ˆã†ã«è£œåŠ©çš„ã«ä½¿ã†æ–¹æ³•ãŒç¾å®Ÿçš„ã‹ã‚‚ã—ã‚Œãªã„ã€‚

ã‚‚ã£ã¨ã‚‚ã€å€‹äººçš„ã«ã¯ Play Framework ã§ã¯ SPA ã‚„ JavaScript ã¯æ¥µåŠ›ä½¿ã‚ãšã«ç´”ç²‹ã« SSR ã ã‘ã§ã‚µã‚¤ãƒˆæ§‹ç¯‰ã—ã¦ã„ãæ–¹ãŒå¥½ã¿ã§ã¯ã‚ã‚‹ã€‚
æœ¬å½“ã«å¿…è¦ãªç®‡æ‰€ã ã‘ JavaScript ã‚’ä½¿ãˆã°ä¸è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã®å¾…ã¡æ™‚é–“ã‚„å®Ÿè¡Œã«ã‹ã‹ã‚‹æ™‚é–“ã‚’çŸ­ç¸®ã§ãã‚‹ã®ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå‘ä¸Šã™ã‚‹ã—ã€æ§‹é€ çš„ã«ã‚·ãƒ³ãƒ—ãƒ«ã«ãªã‚‹ã€‚
ã“ã®è¾ºã¯å¸¸ã«ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã«ãªã‚‹ã®ã§é¸å®šãŒé›£ã—ã„ã€‚
